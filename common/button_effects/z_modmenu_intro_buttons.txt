###_z modmenu intro	#####################################################################
###_[button effects 只读 root的东西]

#_[主机欢迎窗口/其他界面debug]
#_[其他欢迎窗口]
#_[框架模式选择/模式_modmenu/模式_framework/模式_合集]

#_[重要flg]		z_mm_framework_mode_selected=完成模式选择




###_[主机欢迎窗口]	[z_modmenu.1200]	直接开始/模式选择
#_同步[z_mm_button_intro_confirm-选择框架]
z_mm_button_intro_welcome = {
    potential = { is_scope_type = country }	#_当前[国家界面]
	effect = {
		hidden_effect = {
			##_[直接开始]	init/框架模式初始化/开局事件
			if = {
				limit = { has_global_flag = linkage_support }
				
				#_[init]
				remove_country_flag = z_mm_framework_mode_selected	#_清理模式选择完成flg
				set_global_flag = z_framework_activated				#_自动选择框架模式
				
				#_[框架模式初始化]
				z_fw_eft_glbl_framework_mode_flg_init = yes

				#_[开局事件]
				z_mm_lock_menu = yes
				country_event = { id = z_modmenu.1 }
				z_mm_lock_setting_panel = yes
				country_event = { id = z_fw_misc_start.100 }	#_开局指南
			}
			##_[模式选择]
			else = { country_event = { id = z_modmenu.120 } }
		}
		custom_tooltip = z_mm_tip_intro_welcome
	}
}
##_[其他界面debug]
z_mm_button_intro_welcome_debug = {
    potential = { NOT = { is_scope_type = country } }	#_当前[其他界面]
	effect = {
		custom_tooltip = z_mm_tip_intro_welcome_debug
	}
}


###_[其他欢迎窗口]
z_mm_button_intro_confirm_none = {
    potential = { always = yes }
	effect = {
		hidden_effect = {
			if = {
				limit = { is_scope_type = country }
				remove_country_flag = z_mm_framework_mode_selected
			}
			else = { owner = { remove_country_flag = z_mm_framework_mode_selected } }	#_[开启非国家界面]
		}
		custom_tooltip = z_mm_tip_intro_confirm
	}
}




###_[框架模式选择]
#_[完成选择]=开局flg初始化	init/框架模式/菜单模式
z_mm_button_intro_confirm = {
    potential = { has_country_flag = z_mm_framework_mode_selected }
	effect = {
		hidden_effect = {
			##_[init]
			remove_country_flag = z_mm_framework_mode_selected		#_清理模式选择完成flg
			
			##_[框架模式]	框架模式初始化/开局事件
			if = {
				limit = { has_global_flag = z_framework_activated }
				
				#_[框架模式初始化]
				z_fw_eft_glbl_framework_mode_flg_init = yes

				#_[开局事件]
				z_mm_lock_menu = yes
				country_event = { id = z_modmenu.1 }
				z_mm_lock_setting_panel = yes
				country_event = { id = z_fw_misc_start.100 }	#_开局指南
			}
			##_[菜单模式]
			else = {
				set_global_flag = z_fw_flg_glbl_wg_cb_disabled		#_[新战争类型-禁用]
				#_[战争-dd-战力强化]难度初始化
				remove_global_flag = z_fw_core_battle_dd_fp_adpt_hard
				remove_global_flag = z_fw_core_battle_dd_fp_adpt_easy
				set_global_flag = z_fw_core_battle_dd_fp_adpt_standard
			}
		}
		custom_tooltip = z_mm_tip_intro_confirm
	}
}
z_mm_button_intro_confirm_bg = {
    potential = { has_country_flag = z_mm_framework_mode_selected }
	allow = { always = no }
	effect = {
	}
}


##_[模式_modmenu]
z_mm_button_intro_menu_mode_on = {
	potential = {
		has_country_flag = z_mm_framework_mode_selected
		NOR = {
			has_global_flag = linkage_support	#_无尽整合
			has_global_flag = z_framework_activated
		}
	}
	allow = { always = yes }
	effect = {
		hidden_effect = { set_country_flag = z_mm_framework_mode_selected }
		custom_tooltip = z_mm_tip_intro_menu_mode_on
	}
}
z_mm_button_intro_menu_mode_off = {
	potential = {
		OR = {
			AND = {
				has_country_flag = z_mm_framework_mode_selected
				has_global_flag = z_framework_activated
			}
			NOT = { has_country_flag = z_mm_framework_mode_selected }
		}
		NOT = { has_global_flag = linkage_support }	#_无尽整合
	}
	allow = { always = yes }
	effect = {
		hidden_effect = {
			set_country_flag = z_mm_framework_mode_selected
			remove_global_flag = z_framework_activated
		}
		custom_tooltip = z_mm_tip_intro_menu_mode_off
	}
}


##_[模式_framework]
z_mm_button_intro_fw_mode_on = {
	potential = {
		has_country_flag = z_mm_framework_mode_selected
		has_global_flag = z_framework_activated
		NOT = { has_global_flag = linkage_support }	#_无尽整合
	}
	allow = { always = yes }
	effect = {
		hidden_effect = { set_country_flag = z_mm_framework_mode_selected }
		custom_tooltip = z_mm_tip_intro_fw_mode_on
	}
}
z_mm_button_intro_fw_mode_off = {
	potential = {
		OR = {
			AND = {
				has_country_flag = z_mm_framework_mode_selected
				NOT = { has_global_flag = z_framework_activated }
			}
			NOT = { has_country_flag = z_mm_framework_mode_selected }
		}
		NOT = { has_global_flag = linkage_support }	#_无尽整合
	}
	allow = { always = yes }
	effect = {
		hidden_effect = {
			set_country_flag = z_mm_framework_mode_selected
			set_global_flag = z_framework_activated
		}
		custom_tooltip = z_mm_tip_intro_fw_mode_off
	}
}


##_[模式_合集]	只能选择framework	z禁用
z_mm_button_intro_fw_mode_ic = {
	potential = { has_global_flag = linkage_support }	#_无尽整合
	allow = { always = yes }
	effect = {
		hidden_effect = {
			set_country_flag = z_mm_framework_mode_selected
			set_global_flag = z_framework_activated
			every_country = {#_隐藏额外法令
				limit = { is_ai = no }
				set_country_flag = z_fw_flg_cntr_edt_hide
			}
		}
		custom_tooltip = z_mm_tip_intro_fw_mode_ic
	}
}